(function(t){function i(i){for(var a,r,n=i[0],c=i[1],l=i[2],p=0,d=[];p<n.length;p++)r=n[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(i);while(d.length)d.shift()();return s.push.apply(s,l||[]),e()}function e(){for(var t,i=0;i<s.length;i++){for(var e=s[i],a=!0,n=1;n<e.length;n++){var c=e[n];0!==o[c]&&(a=!1)}a&&(s.splice(i--,1),t=r(r.s=e[0]))}return t}var a={},o={"pages/promotion":0},s=[];function r(i){if(a[i])return a[i].exports;var e=a[i]={i:i,l:!1,exports:{}};return t[i].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.e=function(){return Promise.resolve()},r.m=t,r.c=a,r.d=function(t,i,e){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,i){if(1&i&&(t=r(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)r.d(e,a,function(i){return t[i]}.bind(null,a));return e},r.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=i,n=n.slice();for(var l=0;l<n.length;l++)i(n[l]);var u=c;s.push([99,"chunk-vendors","chunk-common"]),e()})({"3fe8":function(t,i,e){"use strict";e.r(i);e("e260"),e("e6cf"),e("cca6"),e("a79d");var a=e("56d7"),o=function(){var t=this,i=t._self._c;return i("div",{class:["wrapper"],style:t.pageThemeStyle},[t.productList.length>0?i("div",{staticClass:"wrapper__topic"},[i("div",{staticClass:"wrapper__topic__top"},[t.activityIcon?i("img",{staticClass:"top__logo",attrs:{src:t.activityIcon,alt:""}}):t._e(),i("div",{class:["top__content",{"top__content--noIcon":!t.activityIcon}]},[i("span",{staticClass:"top__content__name"},[t._v(t._s(t.activityName))]),i("span",{staticClass:"top__content__num"},[t._v(t._s(t.$t("promotion.pieces_goods",[t.total])))])]),t.hasShare?i("div",{staticClass:"top__share",on:{click:t.handleShare}},[t._v(t._s(t.$t("common.share")))]):t._e()]),i("div",{staticClass:"wrapper__topic__content"},[i("img",{staticClass:"content__img content__img--top",attrs:{src:e("bd11"),alt:""}}),i("div",{staticClass:"content__notice"},[!t.showMore&&t.activityDesc?i("div",{ref:"title-wrapper",staticClass:"content__title",on:{click:function(i){return i.stopPropagation(),t.toggleShowMore.apply(null,arguments)}}},[i("span",{ref:"title-content",staticClass:"content__title__main"},[t._v(t._s(t.activityDesc))]),t.showMoreTap?i("p",{staticClass:"content__title__more"},[i("img",{attrs:{src:e("34a2")}})]):t._e()]):i("div",{staticClass:"content__title content__title--more",on:{click:function(i){return i.stopPropagation(),t.toggleShowMore.apply(null,arguments)}}},[t._v(t._s(t.activityDesc))]),!t.showSubMore&&t.activityNotice?i("div",{ref:"sub-title-wrapper",staticClass:"content__title content__title--sub",on:{click:function(i){return i.stopPropagation(),t.toggleSubShowMore.apply(null,arguments)}}},[i("span",{ref:"sub-title-content",staticClass:"content__title__main"},[t._v(t._s(t.activityNotice))]),t.showSubMoreTap?i("p",{staticClass:"content__title__more"},[i("img",{attrs:{src:e("34a2")}})]):t._e()]):i("div",{staticClass:"content__title content__title--more content__title--sub",on:{click:function(i){return i.stopPropagation(),t.toggleSubShowMore.apply(null,arguments)}}},[t._v(t._s(t.activityNotice))])])]),i("div",{staticClass:"wrapper__topic__bg"},[i("img",{attrs:{src:t.activityBanner}}),i("div",{staticClass:"bg"})])]):t._e(),t.productList.length>0?i("div",{staticClass:"wrapper__timer"},[i("div",{staticClass:"prod-time"},[t.firstData.timestamp>0?i("div",{staticClass:"prod-time-wrap"},[i("span",{staticClass:"prod-time-desc"},[t._v(t._s(1===t.firstData.status?t.$tc("promotion.start_end",1):t.$tc("promotion.start_end",2)))]),t.firstData.dd>0?[i("span",{staticClass:"prod-time-r prod-h"},[t._v(t._s(t.firstData.dd||"00"))]),i("span",{staticClass:"prod-time-day"},[t._v(t._s(t.$t("promotion.day")))])]:t._e(),i("span",{staticClass:"prod-time-r prod-h"},[t._v(t._s(t.firstData.hh||"00"))]),i("span",{staticClass:"prod-time-gap"},[t._v(":")]),i("span",{staticClass:"prod-time-r prod-m"},[t._v(t._s(t.firstData.mm||"00"))]),i("span",{staticClass:"prod-time-gap"},[t._v(":")]),i("span",{staticClass:"prod-time-r prod-s"},[t._v(t._s(t.firstData.ss||"00"))])],2):i("span",{staticClass:"prod-time-tip"},[t._v(t._s(t.firstData.timeLabel||t.$t("promotion.activity_over")))])]),i("div",{staticClass:"wrapper__timer__date"},[t._v(t._s(t.beginTime)+" - "+t._s(t.endTime))])]):t._e(),i("div",{staticClass:"wrapper__list"},[i("product-list-card",{attrs:{prodList:t.productList,prodType:2,hasShadow:!1,cardType:"activity",prodEnv:"landing",showAddBtn:"promotion",prodSkinData:t.prodSkinData},on:{handleAddBtn:t.handleAddBtn}})],1),i("shareMask",{attrs:{shareUrl:t.shareUrl},model:{value:t.showShare,callback:function(i){t.showShare=i},expression:"showShare"}}),t.isXhr||0!==t.productList.length?t._e():i("div",{staticClass:"empty"},[i("img",{attrs:{src:t.$t("fashsale.img_fashsale_empty")}}),i("p",[t._v(t._s(t.$t("promotion.no_goods")))])]),t.isXhr&&1===t.pageIndex?i("loading-line"):t._e(),t.skus&&t.skuDefault.showSkuPop?i("selectsku",{attrs:{skus:t.skus,skuDefault:t.skuDefault,isFromTuan:!1,saleActivityTitles:t.isBrandPriceType?t.saleActivityTitles:[],productDetailInfo:t.productDetailInfo},on:{skuConfirmCB:t.skuConfirmCB,showSkuFunc:t.showSkuFunc}}):t._e(),i("storeDialog",{attrs:{shopDetailDto:t.shopDetailDto},on:{hideDialog:t.handleHidetoreDialog},model:{value:t.showStoreDialog,callback:function(i){t.showStoreDialog=i},expression:"showStoreDialog"}})],1)},s=[],r=e("7ee6"),n=r["a"],c=(e("4ec5"),e("2877")),l=Object(c["a"])(n,o,s,!1,null,"406f4bab",null),u=l.exports;e.p=publicPath,Object(a["a"])(u)},"4bb1":function(t,i,e){},"4ec5":function(t,i,e){"use strict";e("4bb1")},"7ee6":function(t,i,e){"use strict";(function(t){var a=e("5530"),o=(e("ac1f"),e("841c"),e("d3b7"),e("99af"),e("498a"),e("159b"),e("1276"),e("a15b"),e("c96a"),e("a026")),s=e("caf9"),r=e("b68d"),n=e("fe47"),c=e("191e"),l=e("4696"),u=e("7fcb"),p=e("603c"),d=e("44e4"),h=e("fec4"),f=e("cd92"),m=e("566a"),v=e("ed08");o["default"].use(s["a"]),i["a"]={components:{previewTips:l["a"],productListCard:f["a"],shareMask:u["a"],loadingLine:d["a"],selectsku:h["a"],storeDialog:m["a"]},mixins:[c["a"],p["a"],r["a"]],data:function(){return{brandId:"",hasShare:t.hasShare,showShare:!1,shareUrl:"",parts:[],activityId:0,activityName:"",activityBanner:"",activityIcon:"",productList:[],activityDesc:"",activityNotice:"",total:0,firstData:{},beginTime:"",endTime:"",pageIndex:1,loadMore:!0,isXhr:!1,showMoreTap:!1,showSubMoreTap:!1,showMore:!1,showSubMore:!1,isShowSku:!1,skuDefault:{showSkuPop:!1,skuType:1,pic:"",price:"",selectId:"",foreign:!1,symbol:""},skus:{},prodCurrent:{},saleActivityTitles:[],showStoreDialog:!1,shopDetailDto:null,productDetailInfo:{}}},computed:{isBrandPriceType:function(){return t.store.isBrandPriceType}},created:function(){var t=this,i=v["a"].parseLocator(window.location.search),e=v["a"].parseUrl(window.location.search,"lower");this.activityId=e.activityid,this.brandId=e.brandid||"",n["a"].init(i,(function(i){t.mchId=i,t.getPageData(!0)}))},destroyed:function(){this.stopTimer()},onReachBottom:function(){!this.isXhr&&this.loadMore&&(this.pageIndex+=1,this.getPageData())},methods:{toggleShowMore:function(){this.showMore=!this.showMore},toggleSubShowMore:function(){this.showSubMore=!this.showSubMore},fetchPageData:function(){if(window._global&&window._global.pageInfo)return Promise.resolve(window._global.pageInfo);var i={activityType:3,activityIdList:[this.activityId],pageIndex:this.pageIndex};return this.brandId&&(i.brandId=this.brandId),t.request({url:"/api/prod/shopspecialsale",method:"POST",data:i})},getPageData:function(){var i=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||!this.isXhr&&this.loadMore)&&(this.isXhr=!0,this.fetchPageData().then((function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.isXhr=!1;var o=a.activityList[0];if(e&&o.activityName&&(t.setNavigationBarTitle({title:o.activityName}),t.wxShare({title:o.activityName})),o){var s=o.activityName,r=o.activityBanner,n=o.activityIcon,c=o.productList,l=o.activityDesc,u=o.activityNotice,p=o.beginTime,d=o.endTime;if(e)i.productList=c||[];else{var h=i.productList;i.productList=h.concat(c||[])}if(1===i.pageIndex&&(i.total=o.total),i.activityName=s,i.activityBanner=r,i.activityIcon=n,i.activityDesc=String(l||"").trim()||s,i.activityNotice=String(u||"").trim()||s,i.beginTime=i.handleTime(p),i.endTime=i.handleTime(d,p,!0),e&&c&&c.length){var f=c[0]||{},m=i.calcTime(c[0].timestamp);f.dd=m.dd,f.hh=m.hh,f.mm=m.mm,f.ss=m.ss,i.firstData=f}return c&&c.length||(i.loadMore=!1),void i.$nextTick((function(){i.stopTimer(),i.startTimer(),i.calcContentHeight()}))}t.showToast({title:i.$t("promotion.failed_activity")})})).catch((function(){i.isXhr=!1,t.showToast({title:i.$t("promotion.failed_activity")})})))},handleShare:function(){var i=this;t.ylog.send({action_type:"click",module_name:"share"}),t.getShareData().then((function(e){t.request({url:"/api/prod/sqactivityshareinfo",method:"POST",data:Object(a["a"])({activityId:i.activityId},e)}).then((function(t){t.shareUrl&&(i.shareUrl=t.shareUrl,i.showShare=!0)}))}))},stopTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},startTimer:function(){var t=this;this.productList.length&&!this.timer&&(this.timer=setInterval((function(){t.countDown()}),1e3))},countDown:function(){var t=this,i=this.productList;i.forEach((function(i){if(i.timestamp>0){i.timestamp-=1;var e=t.calcTime(i.timestamp);i.dd=e.dd,i.hh=e.hh,i.mm=e.mm,i.ss=e.ss,i.timestamp<=0&&(clearTimeout(t.timeout),t.timeout=setTimeout((function(){t.loadMore=!0,t.pageIndex=1,t.getPageData(!0)}),400))}})),this.productList=i,this.firstData=i.length>0&&i[0]||{}},calcTime:function(t){if(t<=0)return{hh:"00",mm:"00",ss:"00"};var i=t,e=Math.floor(i/3600/24),a=Math.floor((i-3600*e*24)/3600),o=Math.floor((i-3600*e*24-3600*a)/60),s=i-3600*e*24-3600*a-60*o;return{dd:this.formatNum(e),hh:this.formatNum(a),mm:this.formatNum(o),ss:this.formatNum(s)}},handleTime:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e=arguments.length>2?arguments[2]:void 0,a=t.split(" "),o=a[0].split("-")||[];if(e){var s=i.split(" "),r=s[0].split("-")||[];r[0]===o[0]&&o.shift()}return"".concat(o.join("-")," ").concat(a[1])},formatNum:function(t){var i=String(t);return i.length?1===i.length?"0".concat(i):i:"00"},calcTitleHeight:function(t,i){return this.$refs[t].offsetHeight<this.$refs[i].offsetHeight},calcContentHeight:function(){this.activityDesc&&(this.showMoreTap=this.calcTitleHeight("title-wrapper","title-content")),this.activityNotice&&(this.showSubMoreTap=this.calcTitleHeight("sub-title-wrapper","sub-title-content"))},handleAddBtn:function(i){var e=this;t.showLoading({title:this.$t("promotion.request_specification")}),this.prodCurrent=i,t.request({url:"/api/prod/sqdetail?productid=".concat(i.id),method:"get"}).then((function(i){if(t.hideLoading(),!Object(v["c"])(i)){var a="",o=!1,s=!1,r=i.activityInfo&&2===i.activityInfo.state;i.price.interval[0]!==i.price.interval[1]&&(a=e.$t("promotion.rise"));var n=i.activityInfo&&i.activityInfo.state<2;i.activityInfo&&5===i.activityInfo.type&&0===i.activityInfo.state&&(n=!1),n&&i.activityInfo&&(4===i.activityInfo.type||6===i.activityInfo.type?(0===i.activityInfo.state&&(s=!0),o=!0):1===i.activityInfo.state&&(o=!0)),3==i.nationType&&(i.price.foreign=!1),e.skus=i.skus,e.skuDefault.showSkuPop=!0,e.skuDefault.pic=i.picList[0].small,e.skuDefault.price=i.price.interval[0],e.skuDefault.interval=a,e.skuDefault.exchangePrice=i.price.exchange?i.price.exchange[0]:"",e.skuDefault.foreign=i.price.foreign,e.skuDefault.symbol=i.price.symbol,e.skuDefault.minNum=i.minOrderNum,e.skuDefault.type=o?3:0,e.skuDefault.skuShowOriginalPrice=s,e.skuDefault.activitySaleout=r,e.skuDefault.vipLogo=i.memberGrade&&i.memberGrade.logoUrl,e.skuDefault.subsidyInterval=i.price.subsidyPrice&&i.price.subsidyPrice[0]!=i.price.subsidyPrice[1]?e.$t("promotion.rise"):"",e.skuDefault.vipInterval=i.price.vipPrice&&i.price.vipPrice[0]!=i.price.vipPrice[1]?e.$t("promotion.rise"):"",e.skuDefault.subsidyExchangePrice=i.price.subsidyExchangePrice&&i.price.subsidyExchangePrice[0],e.skuDefault.vipExchangePrice=i.price.vipExchangePrice&&i.price.vipExchangePrice[0],e.skuDefault.vipPrice=i.price&&i.price.vipPrice&&i.price.vipPrice[0],e.skuDefault.subsidyPrice=i.price.subsidyPrice&&i.price.subsidyPrice[0],e.productDetailInfo=i,i.saleChannel?(e.skuDefault.skuType=10,e.skuDefault.confirmName=e.$t("item.store_buy"),e.shopDetailDto=i.shopDetailDto||null):i.vipNotCanBuyGroup&&i.vipNotCanBuyGroup.inGroup&&2==i.vipNotCanBuyGroup.groupStatus?(e.skuDefault.skuType=11,e.skuDefault.confirmName=i.vipNotCanBuyGroup.nextCanBuyDesc,e.shopDetailDto=null,e.skuDefault.inQualificationsGroup=!1,e.skuDefault.inDrawLots=!1):0==i.state&&i.inQualificationsGroup?(e.skuDefault.inQualificationsGroup=!0,e.skuDefault.skuType=12,e.shopDetailDto=null):i.activityInfo&&25===i.activityInfo.type?(e.skuDefault.inDrawLots=!0,e.skuDefault.skuType=13,e.shopDetailDto=null):(e.skuDefault.skuType=1,e.skuDefault.confirmName="",e.shopDetailDto=null),e.loadSellerInfo(i)}})).catch((function(i){t.hideLoading(),t.showToast({title:i.message||i.msg||e.$t("promotion.failed_specifications")})}))},skuConfirmCB:function(i){var e=this,a=this;if(a.showSkuFunc(!1),10!=i.skuType){if(11!=i.skuType)return 12==i.skuType?t.auth.islogin()?void(t.isMiniApp?wx.miniProgram.navigateTo({url:"/pages/item/item?productId=".concat(this.productDetailInfo.id)}):t.navigateTo({url:"/pages/item/main?productId=".concat(this.productDetailInfo.id)})):void t.auth.tologin():void(13!=i.skuType?t.auth.islogin()?t.auth.authBindMobile().then((function(){var o={CatalogId:i.catalogId,Sale4Price:i.purchaseprice,purchasenum:i.purchasenum,deliveryType:i.deliveryType};t.ylog.send({action_type:"click",module_name:"specification",sub_module_name:"add_to_shoppingcart",sproductid:e.prodCurrent.id,catalog:o.CatalogId}),a.checkData()&&a.addCart(o)})):t.auth.tologin():t.isMiniApp?wx.miniProgram.navigateTo({url:"/subPackage2/pages/activityItem/activityItem?productId=".concat(this.productDetailInfo.id,"&activityId=").concat(this.productDetailInfo.activityInfo&&this.productDetailInfo.activityInfo.activityId)}):t.showToast({title:this.$t("components.selectsku.goto_programs_qualification")}));this.vipDisableConfirm()}else this.handleShowStoreDialog()},showSkuFunc:function(t){this.skuDefault.showSkuPop=!!t},loadSellerInfo:function(i){var e=this;if(i||i.price){var a={productId:i.id,currency:i.price.currency,symbol:i.price.symbol,effectActivityInfo:i.effectActivityInfo,activityInfo:i.activityInfo,brandId:i.brandId,categoryId:i.categoryId,masterCategoryId:i.masterCategoryId,thirdCategoryId:i.thirdCategoryId,domestic:i.domestic,nationType:i.nationType,tariffType:i.tariffType};t.request({url:"/api/prodpromo/getSellerInfo",data:a,method:"post"}).then((function(i){200!==i.code&&t.showToast({title:i.message||e.$t("makeup.failed_information")});var a=i.data,o=[];a.saleActivity&&a.saleActivity[0]&&a.saleActivity[0].title&&(o=a.saleActivity[0].title.split(",")),e.sellerInfo=a,e.saleActivityTitles=o})).catch((function(i){t.showToast({title:i.message||e.$t("promotion.failed_information")})}))}},addCart:function(i){var e=this,a={catalogid:i.CatalogId,purchasenum:i.purchasenum,deliverytype:i.deliveryType,checked:!0};t.request({method:"POST",url:"/api/trading/sqscartprod",data:a}).then((function(i){i.success?t.showToast({title:e.$t("promotion.added_cart_successfully"),icon:"success",className:"longToast"}):t.showToast({title:i.msg||e.$t("promotion.failed_add_cart")})})).catch((function(i){t.showToast({title:i.message||e.$t("promotion.failed_add_cart")})}))},handleShowStoreDialog:function(){this.showStoreDialog=!0},handleHidetoreDialog:function(){this.showStoreDialog=!1},checkData:function(){return 1==this.productDetailInfo.state&&this.productDetailInfo.activityInfo&&0==this.productDetailInfo.activityInfo.state?(t.showToast({title:this.$t("item.sorry_started"),icon:"none"}),!1):!this.productDetailInfo.activityInfo||4!=this.productDetailInfo.activityInfo.type&&6!=this.productDetailInfo.activityInfo.type&&21!=this.productDetailInfo.activityInfo.type&&24!=this.productDetailInfo.activityInfo.type&&22!=this.productDetailInfo.activityInfo.type||0!=this.productDetailInfo.activityInfo.state||(t.showToast({title:this.$t("item.sorry_started"),icon:"none"}),!1)},vipDisableConfirm:function(i){this.productDetailInfo&&(this.productDetailInfo.vipNotCanBuyGroup&&this.productDetailInfo.vipNotCanBuyGroup.inGroup&&this.productDetailInfo.vipNotCanBuyGroup.isVip?t.navigateTo({url:"/pages/membercenter/main"}):t.showToast({title:this.productDetailInfo.vipNotCanBuyGroup.nextCanBuyDesc,icon:"none"}))}}}}).call(this,e("7189")["default"])},99:function(t,i,e){t.exports=e("3fe8")}});