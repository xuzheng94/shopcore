(function(e){function t(t){for(var a,r,i=t[0],s=t[1],d=t[2],u=0,p=[];u<i.length;u++)r=i[u],Object.prototype.hasOwnProperty.call(c,r)&&c[r]&&p.push(c[r][0]),c[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);l&&l(t);while(p.length)p.shift()();return n.push.apply(n,d||[]),o()}function o(){for(var e,t=0;t<n.length;t++){for(var o=n[t],a=!0,r=1;r<o.length;r++){var i=o[r];0!==c[i]&&(a=!1)}a&&(n.splice(t--,1),e=s(s.s=o[0]))}return e}var a={},r={"pages/purchasein":0},c={"pages/purchasein":0},n=[];function i(e){return s.p+"static/js/"+({"brand-wall":"brand-wall","coupon-center-relevance~coupon-relevance~search-relevance":"coupon-center-relevance~coupon-relevance~search-relevance","product-relevance~search-relevance":"product-relevance~search-relevance","search-relevance":"search-relevance","coupon-center-relevance~coupon-relevance~share-modal":"coupon-center-relevance~coupon-relevance~share-modal","coupon-center-relevance":"coupon-center-relevance","coupon-relevance":"coupon-relevance","share-modal":"share-modal","coupon-fission~live-home~product-hot~product-member~product-new~product-newmember~product-spec~shop-~2af75650":"coupon-fission~live-home~product-hot~product-member~product-new~product-newmember~product-spec~shop-~2af75650","coupon-fission":"coupon-fission","live-home":"live-home","shop-video":"shop-video","fly-banner":"fly-banner","img-text":"img-text","live-play":"live-play","live-preview":"live-preview","live-replay":"live-replay","live-subscribe":"live-subscribe","one-img-text":"one-img-text","product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~ab71b53b":"product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~ab71b53b","product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~4d83c133":"product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~4d83c133","product-category~tuan-buy":"product-category~tuan-buy","tuan-buy":"tuan-buy","product-hot~product-member~product-new~product-newmember~product-relevance~product-spec~shop-mustbuy~31482127":"product-hot~product-member~product-new~product-newmember~product-relevance~product-spec~shop-mustbuy~31482127","product-hot":"product-hot","product-member":"product-member","product-new":"product-new","product-newmember":"product-newmember","product-spec":"product-spec","shop-mustbuy":"shop-mustbuy","shop-presale":"shop-presale","shop-promotion":"shop-promotion","shop-seckill":"shop-seckill","shop-privilege":"shop-privilege","product-all~shop-nav":"product-all~shop-nav","product-all":"product-all","product-category":"product-category","product-relevance":"product-relevance","product-topic":"product-topic","shop-nav":"shop-nav","product-brand":"product-brand","product-marketing":"product-marketing","search-bar":"search-bar","shop-banner~turn-banner":"shop-banner~turn-banner","shop-banner":"shop-banner","turn-banner":"turn-banner","shop-coupon":"shop-coupon","shop-noticebar":"shop-noticebar","shop-puzzle":"shop-puzzle","shop-sale":"shop-sale","shop-title":"shop-title",space:"space"}[e]||e)+"."+{"brand-wall":"81746e70","coupon-center-relevance~coupon-relevance~search-relevance":"f1c34ac8","product-relevance~search-relevance":"0d4dd320","search-relevance":"433e74c9","coupon-center-relevance~coupon-relevance~share-modal":"4cf22f4a","coupon-center-relevance":"a299bb0b","coupon-relevance":"d9d2305d","share-modal":"8a8b3689","coupon-fission~live-home~product-hot~product-member~product-new~product-newmember~product-spec~shop-~2af75650":"1215e42b","coupon-fission":"9ffa3d32","live-home":"948b55fd","shop-video":"d0506387","fly-banner":"8efda554","img-text":"2b8c3e92","live-play":"72d7ee72","live-preview":"440963b8","live-replay":"404c7e3c","live-subscribe":"8d8e565b","one-img-text":"3fad927a","product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~ab71b53b":"cd7b5775","product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~4d83c133":"be5dcfef","product-category~tuan-buy":"db1ddf97","tuan-buy":"e1a1669d","product-hot~product-member~product-new~product-newmember~product-relevance~product-spec~shop-mustbuy~31482127":"680af181","product-hot":"4f43b32e","product-member":"17ca97ea","product-new":"007a2b64","product-newmember":"4c1882a2","product-spec":"72eadedd","shop-mustbuy":"62f3115b","shop-presale":"c5fde225","shop-promotion":"fcade842","shop-seckill":"cd2a2834","shop-privilege":"36604948","product-all~shop-nav":"ef4a2736","product-all":"7619e5e5","product-category":"0a372a57","product-relevance":"349f44fc","product-topic":"ac434ca7","shop-nav":"8411da2a","product-brand":"24240d6b","product-marketing":"4692d16b","search-bar":"8727ffe4","shop-banner~turn-banner":"d7b6efef","shop-banner":"6c7ecb4d","turn-banner":"61a7b012","shop-coupon":"aea44b70","shop-noticebar":"854d5bf7","shop-puzzle":"e9ff14eb","shop-sale":"8d2704a3","shop-title":"3eaaacc9",space:"4bf9c43e"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var o=a[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],o={"brand-wall":1,"coupon-center-relevance~coupon-relevance~search-relevance":1,"product-relevance~search-relevance":1,"search-relevance":1,"coupon-center-relevance~coupon-relevance~share-modal":1,"coupon-center-relevance":1,"coupon-relevance":1,"share-modal":1,"coupon-fission~live-home~product-hot~product-member~product-new~product-newmember~product-spec~shop-~2af75650":1,"coupon-fission":1,"live-home":1,"shop-video":1,"fly-banner":1,"img-text":1,"live-play":1,"live-preview":1,"live-replay":1,"live-subscribe":1,"one-img-text":1,"product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~ab71b53b":1,"product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~4d83c133":1,"tuan-buy":1,"product-hot~product-member~product-new~product-newmember~product-relevance~product-spec~shop-mustbuy~31482127":1,"product-hot":1,"product-member":1,"product-new":1,"product-newmember":1,"product-spec":1,"shop-mustbuy":1,"shop-presale":1,"shop-promotion":1,"shop-seckill":1,"shop-privilege":1,"product-all~shop-nav":1,"product-all":1,"product-category":1,"product-relevance":1,"product-topic":1,"shop-nav":1,"product-brand":1,"product-marketing":1,"search-bar":1,"shop-banner":1,"turn-banner":1,"shop-coupon":1,"shop-noticebar":1,"shop-puzzle":1,"shop-sale":1,"shop-title":1,space:1};r[e]?t.push(r[e]):0!==r[e]&&o[e]&&t.push(r[e]=new Promise((function(t,o){for(var a="static/css/"+{"brand-wall":"882d2b071e","coupon-center-relevance~coupon-relevance~search-relevance":"6b58b241d4","product-relevance~search-relevance":"d1df4b937d","search-relevance":"a1ba616906","coupon-center-relevance~coupon-relevance~share-modal":"b107826838","coupon-center-relevance":"48c500cc58","coupon-relevance":"1d85cdc312","share-modal":"9e6ae59b3f","coupon-fission~live-home~product-hot~product-member~product-new~product-newmember~product-spec~shop-~2af75650":"e5e959c166","coupon-fission":"9009073556","live-home":"13a3696224","shop-video":"0630cef0c3","fly-banner":"9d8721e6f6","img-text":"6a776bf85d","live-play":"a68485dea6","live-preview":"fb7710dfcd","live-replay":"1e877aef4b","live-subscribe":"08c8acca98","one-img-text":"37667db2e8","product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~ab71b53b":"39fae890c9","product-all~product-category~product-hot~product-member~product-new~product-newmember~product-releva~4d83c133":"b341049ff1","product-category~tuan-buy":"31d6cfe0d1","tuan-buy":"61abedaf5f","product-hot~product-member~product-new~product-newmember~product-relevance~product-spec~shop-mustbuy~31482127":"59931291d3","product-hot":"283fe87df9","product-member":"5497beac48","product-new":"a19ee226b9","product-newmember":"dc85617255","product-spec":"c8e2ca6658","shop-mustbuy":"72a38b3661","shop-presale":"ab48027a1d","shop-promotion":"962159f3e3","shop-seckill":"06a97ee509","shop-privilege":"6b229afa1c","product-all~shop-nav":"59a9de7db1","product-all":"bd69678fa7","product-category":"028c21e9fb","product-relevance":"5e7f86eb42","product-topic":"c2d93b158a","shop-nav":"039177c190","product-brand":"3c601bf1bc","product-marketing":"b9be98295f","search-bar":"0fcd546294","shop-banner~turn-banner":"31d6cfe0d1","shop-banner":"2b09d54548","turn-banner":"cdbe2fb346","shop-coupon":"5b999435b0","shop-noticebar":"27788d0b12","shop-puzzle":"b26567d3bb","shop-sale":"68560e7bdd","shop-title":"d08b25fc5e",space:"4639f1d333"}[e]+".css",c=s.p+a,n=document.getElementsByTagName("link"),i=0;i<n.length;i++){var d=n[i],u=d.getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(u===a||u===c))return t()}var p=document.getElementsByTagName("style");for(i=0;i<p.length;i++){d=p[i],u=d.getAttribute("data-href");if(u===a||u===c)return t()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=t,l.onerror=function(t){var a=t&&t.target&&t.target.src||c,n=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");n.code="CSS_CHUNK_LOAD_FAILED",n.request=a,delete r[e],l.parentNode.removeChild(l),o(n)},l.href=c;var h=document.getElementsByTagName("head")[0];h.appendChild(l)})).then((function(){r[e]=0})));var a=c[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,o){a=c[e]=[t,o]}));t.push(a[2]=n);var d,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=i(e);var p=new Error;d=function(t){u.onerror=u.onload=null,clearTimeout(l);var o=c[e];if(0!==o){if(o){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",p.name="ChunkLoadError",p.type=a,p.request=r,o[1](p)}c[e]=void 0}};var l=setTimeout((function(){d({type:"timeout",target:u})}),12e4);u.onerror=u.onload=d,document.head.appendChild(u)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(o,a,function(t){return e[t]}.bind(null,a));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var d=window["webpackJsonp"]=window["webpackJsonp"]||[],u=d.push.bind(d);d.push=t,d=d.slice();for(var p=0;p<d.length;p++)t(d[p]);var l=u;n.push([100,"chunk-vendors","chunk-common"]),o()})({100:function(e,t,o){e.exports=o("b2a1")},"13bc":function(e,t,o){"use strict";o("ac34")},"4a0f":function(e,t,o){},"4abf":function(e,t,o){"use strict";(function(e){o("ac1f"),o("841c"),o("a9e3"),o("99af"),o("b0c0");var a=o("191e"),r=o("603c"),c=o("b68d"),n=o("4696"),i=o("fe47"),s=o("b00c"),d=o("3841"),u=o("ed08");t["a"]={name:"PurchaseinCustom",components:{skinwrap:d["default"],previewTips:n["a"]},mixins:[a["a"],r["a"],c["a"]],props:["authCode","pageId"],data:function(){return{activityId:"",pageStatus:1,pageData:{},parts:[],pageStyleMode:null,emptyMsg:"",pageName:"",sellerInfo:{},isPreview:0,gifImgUrl:"",mchId:"",isLogin:e.auth.islogin(),activityType:s["a"].PURCHASE}},computed:{wrapperStyle:function(){return this.moduleStyle(this.pageData)}},created:function(){var e=this,t=u["a"].parseLocator(window.location.search),o=1===Number(t.preview)?1:0;i["a"].init(t,(function(t){e.mchId=t})),this.isPreview=o},mounted:function(){this.getExtraData(),this.getPageData()},beforeDestroy:function(){},methods:{checkLogin:function(){return!!e.auth.islogin()||(e.auth.tologin(),!1)},getExtraData:function(){var t=this;e.request({url:"/api/prod/sqshopextra"}).then((function(e){var o=e.sellerInfo||{};t.sellerInfo=o})).catch((function(e){console.log(e)}))},fetchPageData:function(){return e.request({url:"/api/prod/shophomepageinfo?MerchantId=".concat(this.mchId,"&PageId=").concat(this.pageId,"&tokenCode=").concat(this.authCode)})},getPageData:function(){var t=this;if(!this.pageId)return this.emptyMsg=this.$t("showskin.hani_failed"),void(this.pageStatus=3);this.fetchPageData().then((function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o.code||o.msg)return t.pageStatus=3,void(t.emptyMsg=o.msg||o.message||t.$t("showskin.data_loading_failure"));o.parts&&o.parts.length?(o.name&&(t.pageName=o.name,e.setNavigationBarTitle({title:o.name})),t.pageData=o,t.parts=o.parts,t.pageStyleMode=o.pageStyleMode||1,t.pageStatus=2,o.activityInfo&&o.activityInfo.activityId&&(t.activityId=o.activityInfo.activityId)):t.pageStatus=3})).catch((function(){t.pageStatus=3,e.showToast({title:t.$t("showactivity.failed_activity")})}))},moduleStyle:function(e){var t={},o="";if(e&&e.bgPicUrl){var a=this.handleImgUrl(e.bgPicUrl),r=a.gifImgUrl,c=a.norImgUrl;c&&(t.backgroundImage="url('".concat(c,"')")),r&&(o=r)}return e&&(t.backgroundColor=e.bgColor||"#fff"),this.gifImgUrl=o,t},handleImgUrl:function(t){var o="",a="",r=e.parseImgUrl(t),c=r.imgUrl,n=r.maskUrl;return a=c,n&&(o=n),{gifImgUrl:o,norImgUrl:a}}}}}).call(this,o("7189")["default"])},"625e":function(e,t,o){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper",style:e.pageThemeStyle},[e.isLogin?e._e():t("div",{staticClass:"check-login-mask",on:{click:e.checkLogin}}),e.isPreview?t("preview-tips"):e._e(),1===e.pageStatus?t("div",{staticClass:"placeholder"}):e._e(),2===e.pageStatus?t("div",{staticClass:"showskin",style:e.wrapperStyle},[e.gifImgUrl?t("div",{staticClass:"showskin-mask",style:{backgroundImage:"url('".concat(e.gifImgUrl,"')")}}):e._e(),t("skinwrap",{attrs:{parts:e.parts,pageId:e.pageId,authCode:e.authCode,pageName:e.pageName,activityId:e.activityId,pageData:e.pageData,isPreview:e.isPreview,sellerInfo:e.sellerInfo,pageStyleMode:e.pageStyleMode,activityType:e.activityType}})],1):e._e(),3===e.pageStatus?t("div",{staticClass:"empty_home"},[t("img",{staticClass:"empty-image",attrs:{src:o("4f3c")}}),t("div",{staticClass:"empty_msg"},[e._v(e._s(e.emptyMsg))])]):e._e()],1)},r=[],c=o("4abf"),n=c["a"],i=(o("deba"),o("f477"),o("2877")),s=Object(i["a"])(n,a,r,!1,null,"4e302607",null);t["a"]=s.exports},ac34:function(e,t,o){},b2a1:function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var a=o("56d7"),r=(o("b0c0"),function(){var e=this,t=e._self._c;return t("div",[e.activityInfo.customSubject&&e.voluntarilyCode?t("PurchaseinCustom",{attrs:{authCode:e.authCode,pageId:e.activityInfo.pageId}}):t("div",{class:["container",{"container-hidden":e.empty}],style:[{background:e.bgColor},e.pageThemeStyle]},[e.isLogin||3===e.activityInfo.conditionType?e._e():t("div",{staticClass:"check-login-mask",on:{click:e.checkLogin}}),e.loading&&0===e.pageIndex?t("div",{staticClass:"loading"},[t("loading-line")],1):e._e(),e.hideHeader?e._e():t("purchase-header",{attrs:{bannerUrl:e.bannerUrl||e.defaultBanner,logo:e.iconUrl,name:e.name,bgColor:e.bgColor,showLogo:e.showLogo}},[t("div",{staticClass:"card-container",attrs:{slot:"cardTitle"},slot:"cardTitle"},[t("img",{staticClass:"card-container-top",attrs:{src:o("bd11")}}),t("div",{class:[e.showLogo?"container-content-height":"container-content-low"]}),t("div",{staticClass:"container-content"},[t("div",{staticClass:"content-abs"},[3===e.firstData.activityStatus?t("div",{staticClass:"content-date content-date--font-weight"},[e._v("活动已结束")]):t("div",{staticClass:"content-date"},[e._v(e._s(e.firstData.beginTime)+" - "+e._s(e.firstData.endTime))]),e.activityInfo.showPromptScheme?t("div",{staticClass:"content-desc"},[e._v("可从个人中心-我的内购 进入")]):e._e()])]),t("img",{staticClass:"card-container-bottom",attrs:{src:o("836f")}})])]),e.initListShow?t("div",{staticClass:"card-search"},[t("div",{staticClass:"filter-bar-placeholder"}),t("filter-bar",{staticStyle:{background:"#fff"},attrs:{isFilterFixed:"",source:"search",filterList:e.filterList,"is-show-product":!0,selectedList:e.selectedList,purchasingPlaceholder:e.purchasingPlaceholder},on:{getSearchResult:e.getSearchResult}})],1):e._e(),t("div",{class:["prod",e.empty&&"prod-empty-vacancy"]},[3===e.firstData.activityStatus?t("div",{staticClass:"prod-mask"},[t("div",{staticClass:"mask"})]):e._e(),e.prodList.length>0?t("div",{staticClass:"prod-list"},[t("product-list-card",{attrs:{prodList:e.prodList,showPriceControlType:!1,prodType:2,prodSkinData:e.prodSkinData,navigatorParams:e.navigatorParams,priceLabel:"活动价",cardType:"purchasein"}})],1):e._e(),e.prodList.length>0?t("loadmore",{attrs:{loading:e.loading&&e.pageIndex>0,hasMore:e.loadMore,color:"#fff"}}):e._e(),e.empty?t("div",{staticClass:"prod-empty"},[t("img",{staticClass:"empty-img",attrs:{src:o("1d96"),alt:""}}),t("div",{staticClass:"empty-desc",domProps:{innerHTML:e._s(e.emptyDesc)}})]):e._e()],1)],1),e.watermarkText?t("watermark",{attrs:{watermarkText:e.watermarkText}}):e._e()],1)}),c=[],n=o("f69d"),i=n["a"],s=(o("13bc"),o("2877")),d=Object(s["a"])(i,r,c,!1,null,"04c32276",null),u=d.exports;o.p=publicPath,Object(a["a"])(u)},deba:function(e,t,o){"use strict";o("4a0f")},e6a1:function(e,t,o){},f477:function(e,t,o){"use strict";o("e6a1")},f69d:function(e,t,o){"use strict";(function(e){var a=o("5530"),r=o("2909"),c=(o("ac1f"),o("841c"),o("a9e3"),o("d3b7"),o("c740"),o("a434"),o("b64b"),o("b0c0"),o("00b4"),o("fb6a"),o("99af"),o("b68d")),n=o("603c"),i=o("cd92"),s=o("bce3"),d=o("44e4"),u=o("ed08"),p=o("9fe6"),l=o("13cb"),h=o("4846"),m=o("8efd"),f=o("625e");t["a"]={components:{"purchase-header":p["a"],productListCard:i["a"],loadingLine:d["a"],loadmore:s["a"],filterBar:l["a"],watermark:m["a"],PurchaseinCustom:f["a"]},mixins:[n["a"],c["a"]],data:function(){return{loading:!1,bannerUrl:"",iconUrl:"",bgColor:"#D3EDF7",titleTimerColor:"#090a0e",pageIndex:0,firstData:{},prodList:[],loadMore:!1,hideHeader:!0,isLogin:e.auth.islogin(),activityId:0,authCode:"",navigatorParams:{TradingSpecial:1},activityStatus:1,filterList:{},show:!1,maxPageIndex:0,prodListEmpty:!1,selectedList:{},showLogo:!0,initListShow:!1,showPage:!1,userInfo:{},watermarkText:"",activityInfo:{},purchasingPlaceholder:"",voluntarilyCode:!1}},computed:{defaultBanner:function(){var e=o("79fd");return e},empty:function(){return this.showPage&&!this.initListShow&&0===this.prodList.length},emptyDesc:function(){var e=this.firstData.activityStatus,t="";return this.voluntarilyCode?2===e?t="活动未开始，敬请期待":3===e&&(t="活动已结束"):t="登录后可继续浏览内购商品<br/>2秒后将自动跳转登录页",t}},mounted:function(){var t=this,o=u["a"].parseUrl(window.location.search,"lower"),a=1===Number(o.preview)?1:0;if(a)return this.activityInfo.customSubject=!0,this.voluntarilyCode=!0,void(this.activityInfo.pageId=o.pageid);this.activityId=o.id,this.authCode=o.code;var r={activityId:o.id,authCode:o.code};e.isMiniApp&&o&&o.buycode&&(r.buyCode=o.buycode),this.checkValidBind(r).then((function(a){a?(t.activityInfo=a,t.getActivityInfo(a)):e.isMiniApp?wx.miniProgram.redirectTo({url:"/subPackage/pages/purchaseincheck/purchaseincheck?id=".concat(o.id||"")}):e.redirectTo({url:"/pages/purchaseincheck/main?id=".concat(o.id||"")})})),e.onShow((function(){console.log("触发内购页onShow",t.activityInfo),t.voluntarilyCodeIslogin(t.activityInfo)}))},onReachBottom:function(){if(!this.loading&&this.loadMore){this.pageIndex+=1;var e=this.pageIndex>this.maxPageIndex||this.prodListEmpty;if(e)return;this.getSearchResult({needClearOldData:!1,refreshProduct:!0})}},methods:{checkLogin:function(){return!!e.auth.islogin()||(e.auth.tologin(),!1)},checkValidBind:function(t){var o=this,a=t.activityId,c=t.authCode,n=t.buyCode;return new Promise((function(t){o.loading=!0;var i={activityid:a,tokenCode:c,cookie:e.auth.getCookieId()};n&&(i.buyCode=n),e.request({url:"/api/prod/shopactivity",data:i}).then((function(c){if(c&&c.tokenCode&&(o.authCode=c.tokenCode,!e.auth.isLogin)){var n=h["a"].getSessionStorage("pruchaseinAuth")||[],i=Object(r["a"])(n),s=n.findIndex((function(e){return e.id===a}));s>-1&&i.splice(s,1),i.push({cookieId:e.auth.getCookieId(),id:a,code:c.tokenCode}),h["a"].setSessionStorage("pruchaseinAuth",i)}Object(u["c"])(c)||0===c.authorizeStatus||2===c.authorizeStatus&&!o.authCode?t(!1):(o.activityStatus=c.activityStatus,2===c.authorizeStatus&&o.isLogin&&o.handleBindActivity(),o.loading=!1,t(c))})).catch((function(t){o.loading=!1,e.showToast({title:t.msg||"获取活动信息失败，请重试",duration:2e3})}))}))},getActivityInfo:function(t){if(t){if(0===Object.keys(t).length)return void(0===Object.keys(this.firstData).length&&(this.hideHeader=!0));this.hideHeader=!1,this.name=t.name;var o=t.designConfig.backgroundColor;if(/^https?/.test(t.activityBanner)&&(this.bannerUrl=t.activityBanner),/^https?/.test(t.activityIcon)&&(this.iconUrl=t.activityIcon),t.imageWaterMark&&this.getUserInfo(),this.bgColor=o||"#D3EDF7",this.showLogo=!!t.showLogo,this.firstData=Object(a["a"])({},t),e.setNavigationBarTitle({title:t.name||""}),this.voluntarilyCode=this.voluntarilyCodeIslogin(t),!this.voluntarilyCode)return;this.getSearchResult({needClearOldData:!0,showloading:!0,refreshProduct:!0})}},getUserInfo:function(){var t=this,o=this;e.request("/api/usercenter/squserinfo").then((function(a){if(o.userInfo=a,o.userInfo){var r=o.userInfo.nickname||"";r=r.slice(0,8),t.watermarkText="内购严禁转发 ID".concat(e.auth.getValue("userId")," ").concat(r),t.purchasingPlaceholder=Number(e.auth.getValue("userId"))-123456789}})).catch((function(t){e.showToast({title:t.msg||t.message})}))},voluntarilyCodeIslogin:function(t){var o=this;if(3===t.conditionType&&!e.auth.islogin()){clearTimeout(a);var a=null;return this.showPage=!0,e.showToast({title:"请先完成授权",duration:2e3}),a=setTimeout((function(e){o.checkLogin()}),2e3),!1}return!0},handleBindActivity:function(){e.request({url:"api/prod/sqbindactivity",method:"POST",data:{tokenCode:this.authCode,activityId:this.activityId}}).then((function(t){var o=t.data;o&&o.success||e.showToast({title:"绑定活动失败，请返回重试",duration:2e3})})).catch((function(t){e.showToast({title:t.msg||t.message||"绑定活动失败，请返回重试",duration:2e3})}))},getSearchResult:function(t){var o=this,r=t.needClearOldData,c=t.queryObj,n=t.selectedList,i=t.refreshProduct,s=t.showloading,d=t.changeKeyword,u=e.parseLocator(window.location.search,"lower");this.pageIndex=r?1:this.pageIndex,c&&(this.queryObj=Object(a["a"])({},c)),n&&(this.selectedList=n);var p=Object(a["a"])(Object(a["a"])({},this.queryObj),{},{pageIndex:this.pageIndex,activityId:u.id,refreshProduct:i});if(this.authCode&&(p.tokenCode=this.authCode),!this.loading){this.selectedList&&(e.isBlank(this.selectedList.brandList)||(p.brandList=this.selectedList.brandList),e.isBlank(this.selectedList.categoryList)||(p.thirdCategoryList=this.selectedList.categoryList,p.firstCategoryList=[],p.secondCategoryList=[]),p.minPrice=this.selectedList.minPrice,p.maxPrice=this.selectedList.maxPrice),p.keyword||delete p.keyword,s&&e.showLoading(),this.loading=!0;var l="/api/prod/sqactivityproductsearch";e.request({url:l,data:p,method:"post"}).then((function(t){if(o.loading=!1,o.showPage=!0,t.list&&t.list.length&&(o.initListShow=!0),s&&e.hideLoading(),i){if((t.filterList&&e.isBlank(o.filterList)||d)&&(o.filterList=Object(a["a"])({},t.filterList||{})),(!t.list||!t.list.length)&&(!o.prodList.length||r))return void(r&&(o.prodList=[]));var c=t.list||[],u=o.prodList,l=r?c:u.concat(c),h=!t.list||0===t.list.length,m=t.count||0;o.prodList=l,o.maxPageIndex=m,o.prodListEmpty=h,o.selectedList=(n?o.selectedList:t.selectedList)||{},o.loadMore=p.pageIndex<m&&!h,r&&(document.documentElement.scrollTop=document.body.scrollTop=0)}})).catch((function(t){o.loading=!1,o.showPage=!0,s&&e.hideLoading(),e.showToast({title:t.message||o.$t("makeup.search_failed")})}))}}}}}).call(this,o("7189")["default"])}});