(function(e){function t(t){for(var n,s,r=t[0],c=t[1],l=t[2],m=0,d=[];m<r.length;m++)s=r[m],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],n=!0,r=1;r<i.length;r++){var c=i[r];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},o={"pages/bindmobilenumber":0},a=[];function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=c;a.push([11,"chunk-vendors","chunk-common"]),i()})({"0a2d":function(e,t,i){"use strict";var n=function(){var e=this,t=e._self._c;return t("Popup",{staticClass:"countrydialog",attrs:{value:e.value,zIndex:9999,position:"bottom","close-on-click-overlay":!1},on:{input:e.input}},[t("div",{staticClass:"container"},[t("div",{staticClass:"container__title"},[t("span",{staticClass:"container__title__text"},[e._v(e._s(e.title))]),t("span",{staticClass:"container__title__close",on:{click:function(t){return t.stopPropagation(),e.input(!1)}}})]),t("div",{staticClass:"container__list"},e._l(e.areaList,(function(i,n){return t("div",{key:n,class:["container__list__item",{item__active:e.countryInfo.cnTitle==i.cnTitle&&e.countryInfo.areaCode==i.areaCode}],on:{click:function(t){return e.selectCountry(i)}}},[t("div",{staticClass:"item__name"},[e._v(e._s(i.cnTitle))]),t("div",{staticClass:"item__code"},[e._v(e._s(i.areaCode))])])})),0)])])},o=[],a=(i("8a58"),i("e41f")),s=i("5138"),r={components:{Popup:a["a"]},mixins:[s["a"]],props:{value:{type:Boolean},title:{type:String},areaList:{type:Array},countryInfo:{type:Object}},data:function(){return{countryList:[]}},mounted:function(){},computed:{},methods:{input:function(e){this.$emit("input",e)},selectCountry:function(e){this.$emit("selectCountry",e),this.$emit("input",!1)}}},c=r,l=(i("9a8e"),i("9a74"),i("2877")),u=Object(l["a"])(c,n,o,!1,null,"484984d4",null);t["a"]=u.exports},"0c62":function(e,t,i){e.exports=i.p+"static/img/login_bg_bottom.bf0159e7.png"},11:function(e,t,i){e.exports=i("e039")},4397:function(e,t,i){},"8d81":function(e,t,i){"use strict";i("f20e")},"9a74":function(e,t,i){"use strict";i("4397")},"9a8e":function(e,t,i){"use strict";i("cfdb")},b8201:function(e,t,i){e.exports=i.p+"static/img/login_bg_top.69656eb7.png"},cfdb:function(e,t,i){},d274:function(e,t,i){"use strict";(function(e){i("e17f");var n=i("2241"),o=(i("8a58"),i("e41f")),a=(i("be7f"),i("565f")),s=(i("38d5"),i("772a")),r=(i("d3b7"),i("44e4")),c=i("0db1"),l=i("0a2d"),u=i("b68d"),m=i("ed08"),d=i("4846"),h={smsApi:"/api/usercenter/sqsendverifycode",bindMobile:"/api/usercenter/bindmobile",sqsendverifycode:"/api/usercenter/sqsendverifycode",sqweblogin:"/api/usercenter/sqweblogin"};t["a"]={name:"index",mixins:[u["a"]],data:function(){return{showPage:!1,isSending:!1,loading:!1,s:60,changeNumberForm:{mobile:"",verifyCode:"",mobileArea:"86"},showDialog:!1,areaList:[],countryInfo:{cnTitle:this.$t("memberchangenumber.chinese_mainland"),areaCode:"86"},isXhr:!1,title:"",inviteCode:"",email:"",defaultInviteCode:"",sellerInfo:{},needInviteCode:!1,collectionEmail:!1}},components:{TCaptcha:c["a"],loadingLine:r["a"],countryDialog:l["a"],"van-form":s["a"],"van-field":a["a"],"van-popup":o["a"]},computed:{isCheckButton:function(){return this.needInviteCode?!!(this.changeNumberForm.mobile&&this.changeNumberForm.verifyCode&&this.inviteCode):!(!this.changeNumberForm.mobile||!this.changeNumberForm.verifyCode)},showInviteCode:function(){return this.needInviteCode},isShowEmail:function(){return this.collectionEmail}},mounted:function(){this.getSellerInfo(),this.getSqmemberconfig(),e.setNavigationBarTitle({title:"绑定手机号"})},methods:{getSqmemberconfig:function(){var t=this;e.request({url:"/api/usercenter/sqmemberconfig"}).then((function(e){t.needInviteCode=e.needInvitationCode,t.collectionEmail=e.collectionEmail||!1})).catch((function(e){console.log(e)}))},getSellerInfo:function(){var t=this;e.request({url:"/api/prod/sqshopextra"}).then((function(e){t.showPage=!0,t.sellerInfo=e.sellerInfo||{}})).catch((function(e){t.showPage=!0}))},validate:function(){return!!this.changeNumberForm.mobile||(e.showToast({title:this.$t("memberchangenumber.please_mobile")}),!1)},getMemberCodeTime:function(){var e=this,t=59;this.timer||(this.s=t,this.timer=setInterval((function(){e.s>0&&e.s<=t?e.s--:(e.s=59,e.isSending=!1,clearInterval(e.timer))}),1e3))},handleSendSMS:function(t){var i=this;if(!this.loading&&(this.loading=!0,this.validate())){this.isSending=!0,this.getMemberCodeTime();var n=h.smsApi;e.request({url:n,method:"post",data:{mobile:this.changeNumberForm.mobile,mobileAreaCode:this.countryInfo.areaCode,ticket:t.ticket,randstr:t.randstr,sourceType:t.sourceType}}).then((function(e){e.existUser;i.loading=!1,i.isSending=!0,i.getMemberCodeTime()})).catch((function(t){i.loading=!1,e.showToast({title:t.message||t.msg||i.$t("memberchangenumber.error_sending")})}))}},showCountryDialog:function(){var t=this;this.areaList&&this.areaList.length>0?this.showDialog=!0:(e.showLoading({title:this.$t("common.loading",["..."])}),e.request({url:"api/usercenter/arealist"}).then((function(i){t.areaList=i.countries,t.showDialog=!0,e.hideLoading()})).catch((function(i){e.hideLoading(),e.showToast({title:i.message||i.msg||t.$t("memberchangenumber.failed_obtain")})})))},selectCountry:function(e){this.countryInfo=e,this.changeNumberForm.mobileArea=e.areaCode||"86"},clickCommit:function(){if(console.log("this.isCheckButton",this.isCheckButton),console.log("this.isXhr",this.isXhr),this.isCheckButton){if(this.isXhr)return;if(this.email&&!m["a"].validateEmail(this.email))return void e.showToast({title:this.$t("userinfo.enter_true_email")});this.bindMobileNumber()}},bindMobileNumber:function(){var t=this,i=h.bindMobile,n={mobile:this.changeNumberForm.mobile,verifyCode:this.changeNumberForm.verifyCode,inviteCode:this.defaultInviteCode||this.inviteCode,mobileAreaCode:this.countryInfo.areaCode,email:this.email};console.log("params",n),this.isXhr=!0,e.showLoading({title:this.$t("common.loading",["..."])}),e.request({url:i,method:"post",data:n}).then((function(i){t.isXhr=!1,e.hideLoading(),i.success?(t.setUserInfoValue(i),t.getVersionList().then((function(e){setTimeout((function(){wx.miniProgram.navigateBack()}),500)})).catch((function(e){setTimeout((function(){wx.miniProgram.navigateBack()}),500)}))):(t.s=60,t.isSending=!1,clearInterval(t.timer),e.showToast({title:"绑定手机号失败"}))})).catch((function(i){t.isXhr=!1,t.s=60,t.isSending=!1,clearInterval(t.timer),e.hideLoading(),e.showToast({title:i.message||i.msg||"绑定手机号失败"})}))},showDialogConfirm:function(t){var i=this;n["a"].confirm({title:this.$t("memberchangenumber.sure_phone"),message:this.$t("memberchangenumber.new_account",[this.title]),confirmButtonText:this.$t("memberchangenumber.sure_use"),confirmButtonColor:"#F23340",cancelButtonText:this.$t("memberchangenumber.think_about"),cancelButtonColor:"#666666",className:"show-dialog-confirm"}).then((function(){t?i.commitChangeNumberForm(!0):e.redirectTo({url:"/pages/memberperfection/main"})})).catch((function(){}))},goback:function(){wx.miniProgram.navigateBack()},getVersionList:function(){var t=this;return new Promise((function(i,n){e.request({url:"/api/social/agreementversionlist",method:"GET",data:{}}).then((function(e){var n=d["a"].getStorageSync("versionList");t.protocolList=e,!m["a"].isBlank(e)&&m["a"].isBlank(n)&&d["a"].setStorageSync("versionList",e),i(e)})).catch((function(e){n(e)}))}))},setUserInfoValue:function(t){t&&t.accessToken&&t.userId&&(e.auth.setValue("accessToken",t.accessToken),e.auth.setValue("userId",t.userId),t.deviceId&&e.auth.setValue("deviceId",t.deviceId),t.cookieId&&e.auth.setValue("cookieId",t.cookieId),e.auth.serializeToStorage())}}}}).call(this,i("7189")["default"])},e039:function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("56d7"),o=(i("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"bind-mobile-number",style:e.pageThemeStyle},[e.showPage?[e._m(0),e._m(1),t("div",{staticClass:"bind-mobile-content"},[t("div",{staticClass:"prompt-message"},[t("div",{staticClass:"message-top"},[e._v("绑定手机号")]),t("div",{staticClass:"message-title"},[e._v("请绑定您的"+e._s(e.sellerInfo.name)+"帐号")])]),t("div",{staticClass:"change-number-form"},[t("van-field",{staticClass:"region-phone",attrs:{center:"",clearable:"",placeholder:e.$t("memberchangenumber.please_mobile"),type:"number"},scopedSlots:e._u([{key:"button",fn:function(){return[t("div",{staticClass:"region",on:{click:e.showCountryDialog}},[t("div",{staticClass:"areaCode"},[e._v("+"+e._s(e.countryInfo.areaCode))]),t("img",{staticClass:"trip",attrs:{src:i("5800")}})])]},proxy:!0}],null,!1,955739468),model:{value:e.changeNumberForm.mobile,callback:function(t){e.$set(e.changeNumberForm,"mobile",t)},expression:"changeNumberForm.mobile"}}),t("van-field",{attrs:{maxLength:"6",clearable:"",label:e.$t("memberchangenumber.verification_code"),placeholder:e.$t("memberchangenumber.enter_code")},model:{value:e.changeNumberForm.verifyCode,callback:function(t){e.$set(e.changeNumberForm,"verifyCode",t)},expression:"changeNumberForm.verifyCode"}},[t("template",{slot:"button"},[e.isSending?t("div",{staticClass:"action-sms action-sms--disabled"},[e._v(e._s(e.$t("memberchangenumber.second_again",[e.s])))]):t("TCaptcha",{attrs:{loading:e.loading,validate:e.validate},on:{handleSendSMS:e.handleSendSMS}},[t("div",{staticClass:"action-sms"},[e._v(e._s(e.$t("memberchangenumber.get_code")))])])],1)],2),e.showInviteCode?t("van-field",{attrs:{readonly:!!e.defaultInviteCode,size:"large",clearable:"",maxlength:"6",label:e.$t("platforms.invitation_code"),placeholder:e.$t("platforms.enter_invitation_code")},model:{value:e.inviteCode,callback:function(t){e.inviteCode=t},expression:"inviteCode"}}):e._e(),e.isShowEmail?t("van-field",{attrs:{size:"large",clearable:"",label:e.$t("userinfo.email"),placeholder:e.$t("userinfo.enter_email")},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}):e._e(),t("div",{staticClass:"line"})],1),t("div",{staticClass:"bind-mobile-bottom"},[t("div",{class:["button",{disabled:!e.isCheckButton}],on:{click:e.clickCommit}},[e._v("绑定")])])])]:e.showPage?e._e():t("loading-line"),t("countryDialog",{attrs:{title:e.$t("memberchangenumber.select_international"),areaList:e.areaList,countryInfo:e.countryInfo},on:{selectCountry:e.selectCountry},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}})],2)}),a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-bg-top"},[t("img",{attrs:{src:i("b8201"),alt:""}})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-bg-bottom"},[t("img",{attrs:{src:i("0c62"),alt:""}})])}],s=i("d274"),r=s["a"],c=(i("8d81"),i("2877")),l=Object(c["a"])(r,o,a,!1,null,null,null),u=l.exports;i.p=publicPath,Object(n["a"])(u)},f20e:function(e,t,i){}});